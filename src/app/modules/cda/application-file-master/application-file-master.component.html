<!-- ==========User Assign Modal======== -->

<ng-template #modalUserAssign let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title" *ngIf="selectedApplicationFileUserMap.inspectionFileType == 1">
            Inspection Officers Information</h4>
        <h4 class="modal-title" id="modal-basic-title" *ngIf="selectedApplicationFileUserMap.inspectionFileType == 2">
            Technical Officers Information</h4>
    </div>

    <div class="modal-body">
        <div class="row">
            <div class="col-md-9">
                <div class="col-md-12">
                    <div class="mb-2 row">
                        <label for="userID" class="col-md-4 col-form-label">User</label>
                        <div class="col-md-8">
                            <select id="userID" class="form-select" (change)="userChange($event)"
                                [(ngModel)]="selectedApplicationFileUserMap.userID"
                                [disabled]="selectedApplicationFileUserMap.applicationFileUserMapID > 0 && selectedApplicationFileUserMap.userID > 0">
                                <option [value]=0>Select User</option>
                                <option *ngFor="let user of lstUserByApplicationTypeNDPZ" [value]="user.userAutoID">
                                    {{user.userFullNameBangla}} ({{user.departmentNameBangla}})
                                </option>
                            </select>

                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="mb-2 row">
                        <label for="assignDate" class="col-md-4 col-form-label">Assign Date</label>
                        <div class="col-md-8">
                            <input id="assignDate" type="date" [disabled]="selectedApplicationFileUserMap.userID == 0"
                                [(ngModel)]="selectedApplicationFileUserMap.assignDate"
                                class="form-control customeDatepicker">
                        </div>
                    </div>
                </div>

                <div class="col-md-12 hidden">
                    <div class="mb-2 row">
                        <label for="inspectionRoleType" class="col-md-4 col-form-label">Role Type</label>
                        <div class="col-md-8">
                            <select id="inspectionRoleType" class="form-select"
                                [(ngModel)]="selectedApplicationFileUserMap.inspectionRoleType">
                                <option [value]=0>Select Role</option>
                                <option *ngFor="let obj of lstInspectionRoleType" [value]="obj.inspectionRoleTypeID">
                                    {{obj.inspectionRoleTypeName}}
                                </option>
                            </select>

                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="mb-2 row">
                        <label for="isActive" class="col-md-4 col-form-label">Active</label>
                        <div class="col-md-8">
                            <div class="form-check form-switch form-switch-md mb-3">
                                <input id="isActive" class="form-check-input" type="checkbox" id="isActive"
                                    [(ngModel)]="selectedApplicationFileUserMap.isActive">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="text-right">
                    <p style="width: 100px;height: 100px;border: 1px solid #d8d8d8;margin: 5px 0 0 auto;">
                        <img *ngIf="userImage" style="width: 100%;" src="{{userImage}}" alt="User Image">
                        <img *ngIf="!userImage" style="width: 100%;"
                            src="../../../../assets/images/logo/profile-default.png" alt="User Image">
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="resetModal()"><i class="fas fa-minus"></i>
            Clear</button>
        <button type="button" class="btn btn-success" (click)="submitUserAssign()"><i class="fas fa-check"></i>
            Save</button>
    </div>

    <div class="row">
        <label></label>
        <div class="col-md-12">
            <table class="table">
                <thead>
                    <tr>
                        <th>SL</th>
                        <th>Officer Name</th>
                        <th>Role</th>
                        <th>Assign Date</th>
                        <th class="text-center">Active</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let obj of lstApplicationFileUserMap; let i = index">
                        <td>{{i+1}}</td>
                        <td>{{obj.userNameBangla}}</td>
                        <td>{{obj.inspectionRoleTypeName}}</td>
                        <td>{{obj.assignDate | date : 'dd-MMM-yyyy'}}</td>
                        <td class="text-center">
                            <i
                                [ngClass]="'fa ' + (obj.isActive ? 'fa-check ' : 'fa-times ') + (obj.isActive ? 'text-success' : 'text-danger')"></i>
                        </td>
                        <td>
                            <i class="fa fa-edit" (click)="onFileMapEdit(obj)"></i>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-dark" (click)="modalCloseUserAssign()"><i class="fas fa-times"></i>
            Close</button>
    </div>
</ng-template>

<!-- ==========ApplicationFileMaster Add Modal Start======== -->
<ng-template #modalApplicationFileMaster let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Service Delivery</h4>
    </div>
    <div class="modal-body">
        <!--        ==================Application Type: BC Case======================= -->
        <div class="application-bc-case" *ngIf="selectedApplicationFileMaster.applicationType==1">
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="refNo" class="col-md-3 col-form-label">Approval Number</label>
                    <div class="col-md-9">
                        <input id="refNo" class="form-control" type="text"
                            [(ngModel)]="selectedApplicationFileMaster.refNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="applicationFileMasterName" class="col-md-3 col-form-label">Applicant Name</label>
                    <div class="col-md-9">
                        <input id="applicationFileMasterName" class="form-control" type="text"
                            [(ngModel)]="selectedApplicationFileMaster.applicantName">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="approvalDate" class="col-md-3 col-form-label">Approval Date</label>
                    <div class="col-md-9">
                        <input id="approvalDate" class="form-control" type="date"
                            [(ngModel)]="selectedApplicationFileMaster.approvalDate">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="applicationType" class="col-md-3 col-form-label">Application Type</label>
                    <div class="col-md-9">
                        <select class="form-select" name="" id=""
                            [(ngModel)]="selectedApplicationFileMaster.applicationType">
                            <option *ngFor="let item of lstApplicationType" value="{{item.applicationTypeID}}">
                                {{item.applicationTypeName}}</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="RsNo" class="col-md-3 col-form-label">RS No</label>
                    <div class="col-md-9">
                        <input id="RsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.rsNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="BsNo" class="col-md-3 col-form-label">BS No</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.bsNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="thanaID" class="col-md-3 col-form-label">Thana</label>
                    <div class="col-md-9">
                        <select id="thanaID" class="form-select" [(ngModel)]="selectedApplicationFileMaster.thanaID"
                            (change)="onChangeThana()">
                            <option *ngFor="let thana of lstThana" [value]="thana.thanaID">{{thana.thanaName}}
                                <span *ngIf="thana.thanaNameBangla">({{thana.thanaNameBangla}})</span>
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Mouza</label>
                    <div class="col-md-9">
                        <select id="mouzaID" class="form-select" [(ngModel)]="selectedApplicationFileMaster.mouzaID">
                            <option *ngFor="let mouza of lstMouza" [value]="mouza.mouzaID">{{mouza.mouzaName}}
                                <span *ngIf="mouza.mouzaNameBangla">({{mouza.mouzaNameBangla}})</span>
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Land Owner Name</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.landOwnerName">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Land Lease</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.landLease">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Construction Measure South</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.ConstructionMeasureSouth">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Construction Measure North</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.constructionMeasureNorth">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Construction Measure East</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.constructionMeasureEast">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="constructionMeasureWest" class="col-md-3 col-form-label">Construction Measure West</label>
                    <div class="col-md-9">
                        <input id="constructionMeasureWest" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.constructionMeasureWest">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="LandQuantity" class="col-md-3 col-form-label">Land Quantity</label>
                    <div class="col-md-9">
                        <input id="LandQuantity" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.landQuantity">
                    </div>
                </div>
            </div>
            
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="RSLedgerNumber" class="col-md-3 col-form-label">RS Ledger Number</label>
                    <div class="col-md-9">
                        <input id="RSLedgerNumber" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.rSLedgerNumber">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="LayoutPlotNo" class="col-md-3 col-form-label">Layout Plot No</label>
                    <div class="col-md-9">
                        <input id="LayoutPlotNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.layoutPlotNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="LayoutArea" class="col-md-3 col-form-label">LayoutArea</label>
                    <div class="col-md-9">
                        <input id="LayoutArea" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.layoutArea">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="MainRoadName" class="col-md-3 col-form-label">Main Road Name</label>
                    <div class="col-md-9">
                        <input id="MainRoadName" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.mainRoadName">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="TotalFloor" class="col-md-3 col-form-label">Total Floor</label>
                    <div class="col-md-9">
                        <input id="TotalFloor" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.totalFloor">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="IsApplicantLandOwner" class="col-md-3 col-form-label">Is Applicant Land Owner</label>
                    <div class="col-md-9">
                        <!-- <input id="IsApplicantLandOwner" class="form-control" type="checkbox" [(ngModel)]="selectedApplicationFileMaster.isApplicantLandOwner"> -->
                        <div class="form-check form-switch form-switch-md mb-3">
                            <input class="form-check-input" type="checkbox" [(ngModel)]="selectedApplicationFileMaster.isApplicantLandOwner"
                              id="Status" checked>
                          </div>
                    </div>
                </div>
            </div>

        </div>
<!--==================Application Type: LUC======================= -->
        <div class="application-bc-case" *ngIf="selectedApplicationFileMaster.applicationType!=1">
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="refNo" class="col-md-3 col-form-label">Approval Number luc</label>
                    <div class="col-md-9">
                        <input id="refNo" class="form-control" type="text"
                            [(ngModel)]="selectedApplicationFileMaster.refNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="applicationFileMasterName" class="col-md-3 col-form-label">Applicant Name</label>
                    <div class="col-md-9">
                        <input id="applicationFileMasterName" class="form-control" type="text"
                            [(ngModel)]="selectedApplicationFileMaster.applicantName">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="approvalDate" class="col-md-3 col-form-label">Approval Date</label>
                    <div class="col-md-9">
                        <input id="approvalDate" class="form-control" type="date"
                            [(ngModel)]="selectedApplicationFileMaster.approvalDate">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="applicationType" class="col-md-3 col-form-label">Application Type</label>
                    <div class="col-md-9">
                        <select class="form-select" name="" id=""
                            [(ngModel)]="selectedApplicationFileMaster.applicationType">
                            <option *ngFor="let item of lstApplicationType" value="{{item.applicationTypeID}}">
                                {{item.applicationTypeName}}</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="RsNo" class="col-md-3 col-form-label">RS No</label>
                    <div class="col-md-9">
                        <input id="RsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.rsNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="BsNo" class="col-md-3 col-form-label">BS No</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.bsNo">
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="thanaID" class="col-md-3 col-form-label">Thana</label>
                    <div class="col-md-9">
                        <select id="thanaID" class="form-select" [(ngModel)]="selectedApplicationFileMaster.thanaID"
                            (change)="onChangeThana()">
                            <option *ngFor="let thana of lstThana" [value]="thana.thanaID">{{thana.thanaName}}
                                <span *ngIf="thana.thanaNameBangla">({{thana.thanaNameBangla}})</span>
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Mouza</label>
                    <div class="col-md-9">
                        <select id="mouzaID" class="form-select" [(ngModel)]="selectedApplicationFileMaster.mouzaID">
                            <option *ngFor="let mouza of lstMouza" [value]="mouza.mouzaID">{{mouza.mouzaName}}
                                <span *ngIf="mouza.mouzaNameBangla">({{mouza.mouzaNameBangla}})</span>
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="col-md-12">
                <div class="mb-2 row">
                    <label for="mouzaID" class="col-md-3 col-form-label">Land Owner Name</label>
                    <div class="col-md-9">
                        <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.landOwnerName">
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <div class="mb-2 row">
                <label for="BsNo" class="col-md-3 col-form-label">Inspector Name</label>
                <div class="col-md-9">
                    <input id="BsNo" class="form-control" type="text" [(ngModel)]="selectedApplicationFileMaster.inspector_name">
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="modalClose()"><i class="fas fa-times"></i>
            Close</button>
        <button type="button" class="btn btn-success" (click)="update()"><i class="fas fa-save"></i>
            Update</button>
    </div>
</ng-template>
<!-- ==========ApplicationFileMaster Add Modal End======== -->


<div class="container-fluid">
    <app-page-title title="Service Delivery"></app-page-title>

    <div class="row">
        <div class="col-md-12">
            <div class="card mb-1">
                <div class="card-body p-3">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="filter-row">
                                <div class="row mb-2">
                                    <div class="col-md-3">
                                        <div class="row">
                                            <label for="applicationType"
                                                class="col-md-5 control-label text-right">Application
                                                Type</label>
                                            <div class="col-md-7">
                                                <select id="applicationType" class="form-select"
                                                    (change)="applicationTypeChange()" [(ngModel)]="applicationTypeID">
                                                    <option [value]=0>All Application</option>
                                                    <option *ngFor="let item of lstApplicationType"
                                                        [value]="item.applicationTypeID">
                                                        {{item.applicationTypeName}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 my-1">
                            <button (click)="userAssignModal(1)" class="btn btn-success "><i class="fa fa-user-circle"
                                    aria-hidden="true"></i>
                                Assign for inspection
                            </button>
                            <button *ngIf="showTechnicalAssignButton" (click)="userAssignModal(2)"
                                class="btn btn-info mx-1"><i class="fa fa-user-circle" aria-hidden="true"></i>
                                Assign for technical
                            </button>
                        </div>
                        <div class="col-md-6 my-1">
                            <div class="text-end">
                                <!-- <button (click)="goToInspectionDetialsBCCasePage()"
                                    *ngIf="selectedApplicationFileMaster.applicationFileMasterID>0"
                                    class="btn btn-success"><i class="fas fa-plus"></i>
                                    Inspect
                                </button> &nbsp; -->
                                <button (click)="onEdit()"
                                    *ngIf="selectedApplicationFileMaster.applicationFileMasterID>0"
                                    class="btn btn-primary"><i class="fas fa-edit"></i> Edit
                                </button>
                                <button (click)="onDelete()"
                                    *ngIf="selectedApplicationFileMaster.applicationFileMasterID>0"
                                    class="btn btn-danger mx-1"><i class="fas fa-minus"></i>
                                    Delete</button>
                                <button (click)="onBtnExport()" class="btn btn-outline-info"><i
                                        class="fas fa-file-excel"></i>
                                    Excel</button>
                            </div>
                        </div>

                        <div class="col-lg-12">
                            <ag-grid-angular style="width: 100%; height: 66vh;" class="ag-theme-alpine"
                                [rowData]="lstApplicationFileMaster" [columnDefs]="columnDefs"
                                [gridOptions]="gridOptions" (selectionChanged)="onSelect()"
                                (gridReady)="onGridReady($event)" [components]="frameworkComponents"
                                [overlayNoRowsTemplate]="noRowsTemplate">
                            </ag-grid-angular>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>